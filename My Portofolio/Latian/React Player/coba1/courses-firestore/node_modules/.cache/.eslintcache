[{"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\index.js":"1","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\App.js":"2","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Home.js":"3","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Register.js":"4","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Login.js":"5","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\chat.js":"6","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\Navbar.js":"7","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\PrivateRoute.js":"8","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Profile.js":"9","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\context\\auth.js":"10","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\firebase.js":"11","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\User.js":"12","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\Message.js":"13","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\MessageForm.js":"14","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\Loading.js":"15","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\svg\\Camera.js":"16","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\svg\\Delete.js":"17","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\svg\\Attachment.js":"18"},{"size":219,"mtime":1639115310000,"results":"19","hashOfConfig":"20"},{"size":916,"mtime":1655393699062,"results":"21","hashOfConfig":"20"},{"size":1205,"mtime":1655574976111,"results":"22","hashOfConfig":"20"},{"size":2500,"mtime":1639115310000,"results":"23","hashOfConfig":"20"},{"size":2113,"mtime":1639115310000,"results":"24","hashOfConfig":"20"},{"size":3474,"mtime":1655572661520,"results":"25","hashOfConfig":"20"},{"size":1095,"mtime":1639115310000,"results":"26","hashOfConfig":"20"},{"size":445,"mtime":1639115310000,"results":"27","hashOfConfig":"20"},{"size":2803,"mtime":1639115310000,"results":"28","hashOfConfig":"20"},{"size":667,"mtime":1639115310000,"results":"29","hashOfConfig":"20"},{"size":1005,"mtime":1655382487358,"results":"30","hashOfConfig":"20"},{"size":1477,"mtime":1655427775095,"results":"31","hashOfConfig":"20"},{"size":706,"mtime":1655572647961,"results":"32","hashOfConfig":"20"},{"size":753,"mtime":1639115310000,"results":"33","hashOfConfig":"20"},{"size":347,"mtime":1639115310000,"results":"34","hashOfConfig":"20"},{"size":570,"mtime":1639115310000,"results":"35","hashOfConfig":"20"},{"size":671,"mtime":1639115310000,"results":"36","hashOfConfig":"20"},{"size":612,"mtime":1639115310000,"results":"37","hashOfConfig":"20"},{"filePath":"38","messages":"39","suppressedMessages":"40","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"19dp2od",{"filePath":"41","messages":"42","suppressedMessages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"44","messages":"45","suppressedMessages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"47","messages":"48","suppressedMessages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"51","messages":"52","suppressedMessages":"53","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"54","messages":"55","suppressedMessages":"56","errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"57","usedDeprecatedRules":"50"},{"filePath":"58","messages":"59","suppressedMessages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"61","messages":"62","suppressedMessages":"63","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"64","messages":"65","suppressedMessages":"66","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"67","usedDeprecatedRules":"50"},{"filePath":"68","messages":"69","suppressedMessages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"71","messages":"72","suppressedMessages":"73","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"74","messages":"75","suppressedMessages":"76","errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"77","messages":"78","suppressedMessages":"79","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"80","messages":"81","suppressedMessages":"82","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"83","messages":"84","suppressedMessages":"85","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"86","messages":"87","suppressedMessages":"88","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"89","messages":"90","suppressedMessages":"91","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},{"filePath":"92","messages":"93","suppressedMessages":"94","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"50"},"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\index.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\App.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Home.js",["95","96"],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Register.js",[],[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Login.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\chat.js",["97","98","99","100","101"],[],"import { async } from \"@firebase/util\";\r\nimport { addDoc, collection, doc, getDoc, onSnapshot, orderBy, query, setDoc, Timestamp, updateDoc } from \"firebase/firestore\";\r\nimport { getDownloadURL, ref, uploadBytes } from \"firebase/storage\";\r\nimport react, { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport Message from \"../components/Message\";\r\nimport MessageForm from \"../components/MessageForm\";\r\nimport { auth, db, storage } from \"../firebase\";\r\n\r\nconst Chat = () => {\r\n  const [selectedUser, setSelectedUser] = useState([]);\r\n  const [text, setText] = useState(\"\");\r\n  const [img, setImg] = useState(\"\");\r\n  const [msgs, setMsgs] = useState([]);\r\n  const { id } = useParams();\r\n\r\n  const user1 = auth.currentUser.uid;\r\n  const user2 = id;\r\n  const idMsg = user1 > user2 ? `${user1 + user2}` : `${user2 + user1}`;\r\n  const msgsRef = collection(db, \"messages\", idMsg, \"chat\");\r\n  const q = query(msgsRef, orderBy(\"createdAt\", \"asc\"));\r\n\r\n  useEffect(async () => {\r\n    getDoc(doc(db, \"users\", id)).then((doc) => {\r\n      setSelectedUser(doc.data());\r\n    });\r\n    onSnapshot(q, (querySnapshot) => {\r\n      setMsgs(querySnapshot.docs.map((doc) => doc.data()));\r\n    });\r\n  }, []);\r\n  console.log(selectedUser);\r\n\r\n  console.log(\"Set msg: \", msgs);\r\n\r\n  // const viewMessages = async () => {\r\n  //   const msgsRef = collection(db, \"messages\", idMsg, \"chat\");\r\n  //   const q = query(msgsRef, orderBy(\"createdAt\", \"asc\"));\r\n\r\n  //   onSnapshot(q, (querySnapshot) => {\r\n  //     let msgs = [];\r\n  //     querySnapshot.forEach((doc) => {\r\n  //       msgs.push(doc.data());\r\n  //     });\r\n  //     setMsgs(msgs);\r\n  //   });\r\n\r\n  //   const docSnap = await getDoc(doc(db, \"lastMsg\", id));\r\n  //   if (docSnap.data() && docSnap.data().from !== user1) {\r\n  //     // update last message doc, set unread to false\r\n  //     await updateDoc(doc(db, \"lastMsg\", id), { unread: false });\r\n  //   }\r\n  // }\r\n  // viewMessages();\r\n  // viewMessages();\r\n  // console.log(chat);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const user2 = id;\r\n    const idMsg = user1 > user2 ? `${user1 + user2}` : `${user2 + user1}`;\r\n\r\n    let url;\r\n    if (img) {\r\n      const imgRef = ref(storage, `images/${new Date().getTime()} - ${img.name}`);\r\n      const snap = await uploadBytes(imgRef, img);\r\n      const dlUrl = await getDownloadURL(ref(storage, snap.ref.fullPath));\r\n      url = dlUrl;\r\n    }\r\n\r\n    await addDoc(collection(db, \"messages\", idMsg, \"chat\"), {\r\n      text,\r\n      from: user1,\r\n      to: user2,\r\n      createdAt: Timestamp.fromDate(new Date()),\r\n      media: url || \"\",\r\n    });\r\n\r\n    await setDoc(doc(db, \"lastMsg\", idMsg), {\r\n      text,\r\n      from: user1,\r\n      to: user2,\r\n      createdAt: Timestamp.fromDate(new Date()),\r\n      media: url || \"\",\r\n      unread: true,\r\n    });\r\n\r\n    setText(\"\");\r\n    setImg(\"\");\r\n  };\r\n  return (\r\n    <div className=\"messages_container\">\r\n      {selectedUser ? (\r\n        <>\r\n          <div className=\"messages_user\">\r\n            <h3>{selectedUser.name}</h3>\r\n          </div>\r\n          <div className=\"messages\">{msgs.length ? msgs.map((msg, i) => <Message key={i} msg={msg} user1={user1} />) : null}</div>\r\n          <MessageForm handleSubmit={handleSubmit} text={text} setText={setText} setImg={setImg} />\r\n        </>\r\n      ) : (\r\n        <h3 className=\"no_conv\">Select a user to start conversation</h3>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\Navbar.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\PrivateRoute.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\pages\\Profile.js",["102"],[],"import React, { useState, useEffect } from \"react\";\nimport Camera from \"../components/svg/Camera\";\nimport Img from \"../image1.jpg\";\nimport { storage, db, auth } from \"../firebase\";\nimport {\n  ref,\n  getDownloadURL,\n  uploadBytes,\n  deleteObject,\n} from \"firebase/storage\";\nimport { getDoc, doc, updateDoc } from \"firebase/firestore\";\nimport Delete from \"../components/svg/Delete\";\nimport { useHistory } from \"react-router-dom\";\n\nconst Profile = () => {\n  const [img, setImg] = useState(\"\");\n  const [user, setUser] = useState();\n  const history = useHistory(\"\");\n\n  useEffect(() => {\n    getDoc(doc(db, \"users\", auth.currentUser.uid)).then((docSnap) => {\n      if (docSnap.exists) {\n        setUser(docSnap.data());\n      }\n    });\n\n    if (img) {\n      const uploadImg = async () => {\n        const imgRef = ref(\n          storage,\n          `avatar/${new Date().getTime()} - ${img.name}`\n        );\n        try {\n          if (user.avatarPath) {\n            await deleteObject(ref(storage, user.avatarPath));\n          }\n          const snap = await uploadBytes(imgRef, img);\n          const url = await getDownloadURL(ref(storage, snap.ref.fullPath));\n\n          await updateDoc(doc(db, \"users\", auth.currentUser.uid), {\n            avatar: url,\n            avatarPath: snap.ref.fullPath,\n          });\n\n          setImg(\"\");\n        } catch (err) {\n          console.log(err.message);\n        }\n      };\n      uploadImg();\n    }\n  }, [img]);\n\n  const deleteImage = async () => {\n    try {\n      const confirm = window.confirm(\"Delete avatar?\");\n      if (confirm) {\n        await deleteObject(ref(storage, user.avatarPath));\n\n        await updateDoc(doc(db, \"users\", auth.currentUser.uid), {\n          avatar: \"\",\n          avatarPath: \"\",\n        });\n        history.replace(\"/\");\n      }\n    } catch (err) {\n      console.log(err.message);\n    }\n  };\n  return user ? (\n    <section>\n      <div className=\"profile_container\">\n        <div className=\"img_container\">\n          <img src={user.avatar || Img} alt=\"avatar\" />\n          <div className=\"overlay\">\n            <div>\n              <label htmlFor=\"photo\">\n                <Camera />\n              </label>\n              {user.avatar ? <Delete deleteImage={deleteImage} /> : null}\n              <input\n                type=\"file\"\n                accept=\"image/*\"\n                style={{ display: \"none\" }}\n                id=\"photo\"\n                onChange={(e) => setImg(e.target.files[0])}\n              />\n            </div>\n          </div>\n        </div>\n        <div className=\"text_container\">\n          <h3>{user.name}</h3>\n          <p>{user.email}</p>\n          <hr />\n          <small>Joined on: {user.createdAt.toDate().toDateString()}</small>\n        </div>\n      </div>\n    </section>\n  ) : null;\n};\n\nexport default Profile;\n","D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\context\\auth.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\firebase.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\User.js",["103","104"],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\Message.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\MessageForm.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\Loading.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\svg\\Camera.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\svg\\Delete.js",[],[],"D:\\Tonz\\Documents\\Codingan\\My Portofolio\\Latian\\Query Firebase\\coba1\\courses-firestore\\src\\components\\svg\\Attachment.js",[],[],{"ruleId":"105","severity":1,"message":"106","line":31,"column":6,"nodeType":"107","endLine":31,"endColumn":8,"suggestions":"108"},{"ruleId":"109","severity":1,"message":"110","line":40,"column":28,"nodeType":"111","messageId":"112","endLine":40,"endColumn":29},{"ruleId":"113","severity":1,"message":"114","line":1,"column":10,"nodeType":"115","messageId":"116","endLine":1,"endColumn":15},{"ruleId":"113","severity":1,"message":"117","line":2,"column":90,"nodeType":"115","messageId":"116","endLine":2,"endColumn":99},{"ruleId":"113","severity":1,"message":"118","line":4,"column":8,"nodeType":"115","messageId":"116","endLine":4,"endColumn":13},{"ruleId":"105","severity":1,"message":"119","line":23,"column":13,"nodeType":"120","endLine":30,"endColumn":4},{"ruleId":"105","severity":1,"message":"121","line":30,"column":6,"nodeType":"107","endLine":30,"endColumn":8,"suggestions":"122"},{"ruleId":"105","severity":1,"message":"123","line":52,"column":6,"nodeType":"107","endLine":52,"endColumn":11,"suggestions":"124"},{"ruleId":"105","severity":1,"message":"125","line":16,"column":6,"nodeType":"107","endLine":16,"endColumn":8,"suggestions":"126"},{"ruleId":"127","severity":2,"message":"128","line":43,"column":24,"nodeType":"115","messageId":"129","endLine":43,"endColumn":34},"react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'user1'. Either include it or remove the dependency array.","ArrayExpression",["130"],"no-sequences","Unexpected use of comma operator.","SequenceExpression","unexpectedCommaExpression","no-unused-vars","'async' is defined but never used.","Identifier","unusedVar","'updateDoc' is defined but never used.","'react' is defined but never used.","Effect callbacks are synchronous to prevent race conditions. Put the async function inside:\n\nuseEffect(() => {\n  async function fetchData() {\n    // You can await here\n    const response = await MyAPI.getData(someId);\n    // ...\n  }\n  fetchData();\n}, [someId]); // Or [] if effect doesn't need props or state\n\nLearn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching","ArrowFunctionExpression","React Hook useEffect has missing dependencies: 'id' and 'q'. Either include them or remove the dependency array.",["131"],"React Hook useEffect has a missing dependency: 'user.avatarPath'. Either include it or remove the dependency array.",["132"],"React Hook useEffect has missing dependencies: 'user1' and 'user2'. Either include them or remove the dependency array.",["133"],"no-undef","'selectUser' is not defined.","undef",{"desc":"134","fix":"135"},{"desc":"136","fix":"137"},{"desc":"138","fix":"139"},{"desc":"140","fix":"141"},"Update the dependencies array to be: [user1]",{"range":"142","text":"143"},"Update the dependencies array to be: [id, q]",{"range":"144","text":"145"},"Update the dependencies array to be: [img, user.avatarPath]",{"range":"146","text":"147"},"Update the dependencies array to be: [user1, user2]",{"range":"148","text":"149"},[757,759],"[user1]",[1218,1220],"[id, q]",[1438,1443],"[img, user.avatarPath]",[497,499],"[user1, user2]"]